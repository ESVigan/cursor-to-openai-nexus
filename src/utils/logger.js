const a0_0x41baca=a0_0x3ac2;(function(_0x51c7c8,_0x413738){const _0x5e5800=a0_0x3ac2,_0x1fc703=_0x51c7c8();while(!![]){try{const _0x228e7d=-parseInt(_0x5e5800(0x14e))/0x1+parseInt(_0x5e5800(0x14a))/0x2*(-parseInt(_0x5e5800(0x145))/0x3)+-parseInt(_0x5e5800(0x16d))/0x4*(parseInt(_0x5e5800(0x176))/0x5)+-parseInt(_0x5e5800(0x186))/0x6*(parseInt(_0x5e5800(0x162))/0x7)+-parseInt(_0x5e5800(0x15f))/0x8+-parseInt(_0x5e5800(0x18e))/0x9*(-parseInt(_0x5e5800(0x17d))/0xa)+-parseInt(_0x5e5800(0x185))/0xb*(-parseInt(_0x5e5800(0x158))/0xc);if(_0x228e7d===_0x413738)break;else _0x1fc703['push'](_0x1fc703['shift']());}catch(_0x14c5af){_0x1fc703['push'](_0x1fc703['shift']());}}}(a0_0x2d7c,0xc72f5));const a0_0x2256f3=(function(){let _0x3418e9=!![];return function(_0x1f6b3e,_0xede99e){const _0xb5f198=_0x3418e9?function(){if(_0xede99e){const _0x1f6916=_0xede99e['apply'](_0x1f6b3e,arguments);return _0xede99e=null,_0x1f6916;}}:function(){};return _0x3418e9=![],_0xb5f198;};}()),a0_0x40608f=a0_0x2256f3(this,function(){const _0x141802=a0_0x3ac2;return a0_0x40608f[_0x141802(0x144)]()[_0x141802(0x15b)](_0x141802(0x14b))[_0x141802(0x144)]()['constructor'](a0_0x40608f)[_0x141802(0x15b)](_0x141802(0x14b));});a0_0x40608f();const fs=require('fs'),path=require(a0_0x41baca(0x142));let config=null;function getConfig(){const _0x2c5416=a0_0x41baca;if(!config)try{config=require('../config/config');}catch(_0x10866c){console[_0x2c5416(0x179)](_0x2c5416(0x165),_0x10866c[_0x2c5416(0x174)]),config={'log':{'level':'INFO','format':_0x2c5416(0x152)}};}return config;}const LOG_LEVELS={'ERROR':0x0,'WARN':0x1,'INFO':0x2,'DEBUG':0x3,'TRACE':0x4,'HTTP':0x2};let currentLogLevel=LOG_LEVELS[a0_0x41baca(0x16b)],logFormat=a0_0x41baca(0x152);const COLORS={'RESET':'\x1b[0m','RED':'\x1b[31m','YELLOW':a0_0x41baca(0x16e),'GREEN':a0_0x41baca(0x169),'BLUE':'\x1b[34m','CYAN':a0_0x41baca(0x172)},LOG_DIR=path[a0_0x41baca(0x157)](__dirname,a0_0x41baca(0x16a)),LOG_FILE=path[a0_0x41baca(0x157)](LOG_DIR,a0_0x41baca(0x17c)),MAX_LOG_SIZE=0xa*0x400*0x400;let logToFile=![];const memoryLogs=[],MAX_MEMORY_LOGS=0x3e8;function ensureLogDirExists(){const _0x330aa8=a0_0x41baca;try{return!fs[_0x330aa8(0x163)](LOG_DIR)&&fs[_0x330aa8(0x187)](LOG_DIR,{'recursive':!![]}),!![];}catch(_0x53546e){return console[_0x330aa8(0x179)](_0x330aa8(0x18a)+_0x53546e[_0x330aa8(0x174)]),![];}}function initFileLogging(){const _0x3e73fd=a0_0x41baca,_0x1a3604=getConfig();if(process['env'][_0x3e73fd(0x147)]===_0x3e73fd(0x18f)||_0x1a3604[_0x3e73fd(0x13d)]&&_0x1a3604['log'][_0x3e73fd(0x170)]){if(ensureLogDirExists()){logToFile=!![];if(fs[_0x3e73fd(0x163)](LOG_FILE)){const _0x326fb3=fs['statSync'](LOG_FILE);_0x326fb3[_0x3e73fd(0x141)]>MAX_LOG_SIZE&&rotateLogFile();}return!![];}}return![];}function rotateLogFile(){const _0x2f8d10=a0_0x41baca;try{const _0x51e876=new Date()[_0x2f8d10(0x180)]()[_0x2f8d10(0x181)](/[:.]/g,'-'),_0x1b1eb2=path[_0x2f8d10(0x157)](LOG_DIR,'app-'+_0x51e876+_0x2f8d10(0x14d));fs[_0x2f8d10(0x163)](LOG_FILE)&&fs[_0x2f8d10(0x184)](LOG_FILE,_0x1b1eb2);const _0x5ce5aa=fs[_0x2f8d10(0x13e)](LOG_DIR)[_0x2f8d10(0x14c)](_0x3899bc=>_0x3899bc[_0x2f8d10(0x153)]('app-')&&_0x3899bc['endsWith'](_0x2f8d10(0x14d)))[_0x2f8d10(0x17f)]()[_0x2f8d10(0x17e)]();_0x5ce5aa['length']>0xa&&_0x5ce5aa[_0x2f8d10(0x154)](0xa)['forEach'](_0x5ebf05=>{const _0x2abd50=_0x2f8d10;try{fs[_0x2abd50(0x150)](path[_0x2abd50(0x157)](LOG_DIR,_0x5ebf05));}catch(_0x2506de){console[_0x2abd50(0x179)]('删除旧日志文件失败:\x20'+_0x2506de[_0x2abd50(0x174)]);}});}catch(_0x3fc09c){console['error'](_0x2f8d10(0x15a)+_0x3fc09c['message']),logToFile=![];}}function addLogToMemory(_0x3f13a2,_0x59f04f,..._0x30747c){const _0x199edf=a0_0x41baca,_0x574995={'level':_0x3f13a2,'timestamp':_0x59f04f,'message':_0x30747c[_0x199edf(0x159)](_0x507f47=>typeof _0x507f47==='object'?JSON[_0x199edf(0x173)](_0x507f47):String(_0x507f47))[_0x199edf(0x157)]('\x20')};memoryLogs[_0x199edf(0x15e)](_0x574995),memoryLogs[_0x199edf(0x140)]>MAX_MEMORY_LOGS&&memoryLogs[_0x199edf(0x168)]();}function writeLogToFile(_0x458964,_0x3dee19,..._0x4373d4){const _0x57f283=a0_0x41baca;if(!logToFile)return;try{let _0x2bcd31;if(logFormat===_0x57f283(0x188)){const _0x1d8035=_0x4373d4['map'](_0x1f0532=>typeof _0x1f0532==='object'?_0x1f0532:String(_0x1f0532)),_0x3a7a3d={'level':_0x458964,'timestamp':_0x3dee19,'message':_0x1d8035['length']===0x1?_0x1d8035[0x0]:_0x1d8035};_0x2bcd31=JSON[_0x57f283(0x173)](_0x3a7a3d)+'\x0a';}else _0x2bcd31='['+_0x458964+']\x20'+_0x3dee19+'\x20'+_0x4373d4[_0x57f283(0x159)](_0xd631e1=>typeof _0xd631e1===_0x57f283(0x161)?JSON[_0x57f283(0x173)](_0xd631e1):_0xd631e1)['join']('\x20')+'\x0a';fs[_0x57f283(0x143)](LOG_FILE,_0x2bcd31);const _0x195aa6=fs['statSync'](LOG_FILE);_0x195aa6[_0x57f283(0x141)]>MAX_LOG_SIZE&&rotateLogFile();}catch(_0x40f1a9){console['error'](_0x57f283(0x18d)+_0x40f1a9[_0x57f283(0x174)]),logToFile=![];}}function a0_0x3ac2(_0xafb3b7,_0x572ab0){const _0x46f6fc=a0_0x2d7c();return a0_0x3ac2=function(_0x40608f,_0x2256f3){_0x40608f=_0x40608f-0x13d;let _0x2d7cb1=_0x46f6fc[_0x40608f];if(a0_0x3ac2['jnUrAS']===undefined){var _0x3ac254=function(_0x205bf8){const _0x43a573='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x48ec22='',_0x3418e9='',_0x1f6b3e=_0x48ec22+_0x3ac254;for(let _0xede99e=0x0,_0xb5f198,_0x1f6916,_0x10866c=0x0;_0x1f6916=_0x205bf8['charAt'](_0x10866c++);~_0x1f6916&&(_0xb5f198=_0xede99e%0x4?_0xb5f198*0x40+_0x1f6916:_0x1f6916,_0xede99e++%0x4)?_0x48ec22+=_0x1f6b3e['charCodeAt'](_0x10866c+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0xb5f198>>(-0x2*_0xede99e&0x6)):_0xede99e:0x0){_0x1f6916=_0x43a573['indexOf'](_0x1f6916);}for(let _0x53546e=0x0,_0x1a3604=_0x48ec22['length'];_0x53546e<_0x1a3604;_0x53546e++){_0x3418e9+='%'+('00'+_0x48ec22['charCodeAt'](_0x53546e)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3418e9);};a0_0x3ac2['gfwnSd']=_0x3ac254,_0xafb3b7=arguments,a0_0x3ac2['jnUrAS']=!![];}const _0x51fa9a=_0x46f6fc[0x0],_0x46782e=_0x40608f+_0x51fa9a,_0x24a6ec=_0xafb3b7[_0x46782e];if(!_0x24a6ec){const _0x326fb3=function(_0x51e876){this['YCKgln']=_0x51e876,this['hLPNkr']=[0x1,0x0,0x0],this['CxjdSo']=function(){return'newState';},this['usgfOQ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['yGAfnb']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x326fb3['prototype']['ZgLpjc']=function(){const _0x1b1eb2=new RegExp(this['usgfOQ']+this['yGAfnb']),_0x5ce5aa=_0x1b1eb2['test'](this['CxjdSo']['toString']())?--this['hLPNkr'][0x1]:--this['hLPNkr'][0x0];return this['uUWErS'](_0x5ce5aa);},_0x326fb3['prototype']['uUWErS']=function(_0x3899bc){if(!Boolean(~_0x3899bc))return _0x3899bc;return this['meIebN'](this['YCKgln']);},_0x326fb3['prototype']['meIebN']=function(_0x5ebf05){for(let _0x2506de=0x0,_0x3fc09c=this['hLPNkr']['length'];_0x2506de<_0x3fc09c;_0x2506de++){this['hLPNkr']['push'](Math['round'](Math['random']())),_0x3fc09c=this['hLPNkr']['length'];}return _0x5ebf05(this['hLPNkr'][0x0]);},new _0x326fb3(a0_0x3ac2)['ZgLpjc'](),_0x2d7cb1=a0_0x3ac2['gfwnSd'](_0x2d7cb1),_0xafb3b7[_0x46782e]=_0x2d7cb1;}else _0x2d7cb1=_0x24a6ec;return _0x2d7cb1;},a0_0x3ac2(_0xafb3b7,_0x572ab0);}function getTimestamp(){const _0x5f361b=a0_0x41baca;return new Date()[_0x5f361b(0x180)]();}function setLogLevel(_0x37ca93){const _0x4ccf26=a0_0x41baca;if(typeof _0x37ca93==='string')_0x37ca93=_0x37ca93[_0x4ccf26(0x171)](),LOG_LEVELS[_0x37ca93]!==undefined?currentLogLevel=LOG_LEVELS[_0x37ca93]:error(_0x4ccf26(0x164)+_0x37ca93);else typeof _0x37ca93==='number'&&_0x37ca93>=0x0&&_0x37ca93<=0x4?currentLogLevel=_0x37ca93:error('无效的日志级别:\x20'+_0x37ca93);}function setLogFormat(_0x422ed2){const _0x522ce8=a0_0x41baca,_0x2e109c=['colored',_0x522ce8(0x188),_0x522ce8(0x14f)];return _0x2e109c[_0x522ce8(0x189)](_0x422ed2)?(logFormat=_0x422ed2,!![]):(error('无效的日志格式:\x20'+_0x422ed2),![]);}function formatConsoleLog(_0x2b91f8,_0x255940,_0x41fd60,..._0x252f1b){const _0x138abf=a0_0x41baca;if(logFormat===_0x138abf(0x188)){const _0x3228f8=_0x252f1b[_0x138abf(0x159)](_0x3d4324=>typeof _0x3d4324===_0x138abf(0x161)?_0x3d4324:String(_0x3d4324));return JSON[_0x138abf(0x173)]({'level':_0x2b91f8,'timestamp':_0x255940,'message':_0x3228f8[_0x138abf(0x140)]===0x1?_0x3228f8[0x0]:_0x3228f8});}else return logFormat===_0x138abf(0x14f)?'['+_0x2b91f8+']\x20'+_0x255940+'\x20'+_0x252f1b[_0x138abf(0x157)]('\x20'):_0x41fd60+'['+_0x2b91f8+']\x20'+_0x255940+COLORS[_0x138abf(0x166)]+'\x20'+_0x252f1b[_0x138abf(0x157)]('\x20');}function a0_0x2d7c(){const _0xe89a4e=['5PEL5B+x5PAh5lU26l2U6l2S5AsX6lsLoIa','C2vHCMnO','zM9YBwf0','DgLTzxn0yw1W','Dw5ZAgLMDa','oteWmdmXmM9SChv4BG','sfruua','B2jQzwn0','ndm0n0f2ufPqEq','zxHPC3rZu3LUyW','5PEG5Pwi55Qe5PEL5B+x57QN5yIRoIa','5yQG6l296ywn572U5PAh5lU25AsX6lsLoG','uKvtrvq','uKve','Cg9W','g1SZmM0','lI4VlI4VBg9NCW','su5gtW','q1LbtG','mZq3odbKrKPTugW','g1SZm20','v0fstG','Dg9gAwXL','Dg9vChbLCKnHC2u','g1SZnM0','C3rYAw5NAwz5','BwvZC2fNzq','D2fYBG','ntKWCgLHA0P2','qKXvrq','C3rHCNruAw1L','zxjYB3i','revcvuC','CgfNzvnPEMu','yxbWlMXVzW','mtq1nJbeqK1sC1a','CMv2zxjZzq','C29YDa','Dg9ju09tDhjPBMC','CMvWBgfJzq','wuvmte9x','zxHWB3j0CW','CMvUyw1Lu3LUyW','mJe5nJu5ANfszfrt','mtiYndbMCwP4AfG','BwTKAxjtEw5J','ANnVBG','Aw5JBhvKzxm','5yIB5BU65PEL5B+x55UU5B2v5AsX6lsLoIa','5PAh5lU25PEL5B+x5BEY5zcV55sO','te9hx0zpuK1bva','5yAz5ywL5PEL5B+x5PAh5lU25AsX6lsLoIa','mZi4nvjuyxD2zW','Dhj1zq','Bg9N','CMvHzgrPCLn5BMm','vfjbq0u','BgvUz3rO','C2L6zq','Cgf0Aa','yxbWzw5KrMLSzvn5BMm','Dg9tDhjPBMC','m2XkBxbpCa','rvjst1i','te9hx1rpx0zjteu','5PAh5lU25PEL5B+x5BEY56Ab55sO','zw52','ntqYmduWrwflrhH3','kcGOlISPkYKRksSK','zMLSDgvY','lMXVzW','mtq3nZq4rgHTAxjn','Dgv4Da','Dw5SAw5Ru3LUyW','te9hx0XfvKvm','y29SB3jLza','C3rHCNrZv2L0Aa','C2XPy2u','Dg9mB3DLCKnHC2u','Bgv2zwW','AM9PBG','mJq4ngPiq05grW','BwfW'];a0_0x2d7c=function(){return _0xe89a4e;};return a0_0x2d7c();}function error(..._0x148028){const _0x4ab812=a0_0x41baca;if(currentLogLevel>=LOG_LEVELS[_0x4ab812(0x146)]){const _0x33e8fb=getTimestamp(),_0x41d8cd=formatConsoleLog(_0x4ab812(0x146),_0x33e8fb,COLORS[_0x4ab812(0x167)],..._0x148028);console[_0x4ab812(0x179)](_0x41d8cd),writeLogToFile('ERROR',_0x33e8fb,..._0x148028),addLogToMemory(_0x4ab812(0x146),_0x33e8fb,..._0x148028);}}function warn(..._0x4a6738){const _0x566fe9=a0_0x41baca;if(currentLogLevel>=LOG_LEVELS[_0x566fe9(0x16f)]){const _0x188722=getTimestamp(),_0x2b3636=formatConsoleLog(_0x566fe9(0x16f),_0x188722,COLORS[_0x566fe9(0x182)],..._0x4a6738);console[_0x566fe9(0x175)](_0x2b3636),writeLogToFile(_0x566fe9(0x16f),_0x188722,..._0x4a6738),addLogToMemory(_0x566fe9(0x16f),_0x188722,..._0x4a6738);}}function info(..._0x556682){const _0x7973f7=a0_0x41baca;if(currentLogLevel>=LOG_LEVELS['INFO']){const _0x199b8d=getTimestamp(),_0x3ea41e=formatConsoleLog(_0x7973f7(0x16b),_0x199b8d,COLORS['GREEN'],..._0x556682);console[_0x7973f7(0x13d)](_0x3ea41e),writeLogToFile(_0x7973f7(0x16b),_0x199b8d,..._0x556682),addLogToMemory(_0x7973f7(0x16b),_0x199b8d,..._0x556682);}}function debug(..._0x41e3b4){const _0x8ae9f2=a0_0x41baca;if(currentLogLevel>=LOG_LEVELS[_0x8ae9f2(0x17a)]){const _0x3ad826=getTimestamp(),_0x4e4254=formatConsoleLog(_0x8ae9f2(0x17a),_0x3ad826,COLORS[_0x8ae9f2(0x177)],..._0x41e3b4);console[_0x8ae9f2(0x13d)](_0x4e4254),writeLogToFile('DEBUG',_0x3ad826,..._0x41e3b4),addLogToMemory(_0x8ae9f2(0x17a),_0x3ad826,..._0x41e3b4);}}function trace(..._0x122106){const _0x349183=a0_0x41baca;if(currentLogLevel>=LOG_LEVELS[_0x349183(0x13f)]){const _0xbc363c=getTimestamp(),_0x1438ba=formatConsoleLog(_0x349183(0x13f),_0xbc363c,COLORS[_0x349183(0x16c)],..._0x122106);console[_0x349183(0x13d)](_0x1438ba),writeLogToFile('TRACE',_0xbc363c,..._0x122106),addLogToMemory(_0x349183(0x13f),_0xbc363c,..._0x122106);}}function http(..._0x50f464){const _0x41bd5e=a0_0x41baca;if(currentLogLevel>=LOG_LEVELS['INFO']){const _0x48d2b5=getTimestamp(),_0x447ffa=formatConsoleLog(_0x41bd5e(0x160),_0x48d2b5,COLORS[_0x41bd5e(0x16c)],..._0x50f464);console['log'](_0x447ffa),writeLogToFile(_0x41bd5e(0x160),_0x48d2b5,..._0x50f464),addLogToMemory(_0x41bd5e(0x160),_0x48d2b5,..._0x50f464);}}function getLogs(_0x16d848={}){const _0x5f3ced=a0_0x41baca;let _0x4dff35=[...memoryLogs];_0x16d848[_0x5f3ced(0x156)]&&(_0x4dff35=_0x4dff35[_0x5f3ced(0x14c)](_0x19608a=>_0x19608a[_0x5f3ced(0x156)]===_0x16d848[_0x5f3ced(0x156)]));_0x16d848[_0x5f3ced(0x178)]&&(_0x4dff35=_0x4dff35[_0x5f3ced(0x14c)](_0x4eb4d5=>new Date(_0x4eb4d5[_0x5f3ced(0x15d)])>=new Date(_0x16d848[_0x5f3ced(0x178)])));_0x16d848['endTime']&&(_0x4dff35=_0x4dff35['filter'](_0x47934b=>new Date(_0x47934b['timestamp'])<=new Date(_0x16d848['endTime'])));if(_0x16d848[_0x5f3ced(0x15b)]){const _0x594773=_0x16d848[_0x5f3ced(0x15b)][_0x5f3ced(0x155)]();_0x4dff35=_0x4dff35[_0x5f3ced(0x14c)](_0x597f02=>_0x597f02['message']['toLowerCase']()[_0x5f3ced(0x189)](_0x594773)||_0x597f02['level'][_0x5f3ced(0x155)]()[_0x5f3ced(0x189)](_0x594773));}const _0x51aed7=_0x16d848['page']||0x1,_0xa0cd44=_0x16d848[_0x5f3ced(0x17b)]||0x64,_0x5108b7=(_0x51aed7-0x1)*_0xa0cd44,_0x134199=_0x5108b7+_0xa0cd44;return{'logs':_0x4dff35['slice'](_0x5108b7,_0x134199),'total':_0x4dff35[_0x5f3ced(0x140)],'page':_0x51aed7,'pageSize':_0xa0cd44};}function clearMemoryLogs(){const _0x37ff4a=a0_0x41baca;memoryLogs[_0x37ff4a(0x140)]=0x0,info('内存日志已清除');}function initialize(){const _0x180179=a0_0x41baca;try{const _0xf9efd1=getConfig(),_0x579654=process[_0x180179(0x149)][_0x180179(0x151)];if(_0x579654)setLogLevel(_0x579654);else _0xf9efd1&&_0xf9efd1[_0x180179(0x13d)]&&_0xf9efd1[_0x180179(0x13d)]['level']&&setLogLevel(_0xf9efd1[_0x180179(0x13d)][_0x180179(0x156)]);const _0x430fdd=process[_0x180179(0x149)][_0x180179(0x18c)];if(_0x430fdd)setLogFormat(_0x430fdd);else _0xf9efd1&&_0xf9efd1[_0x180179(0x13d)]&&_0xf9efd1['log'][_0x180179(0x15c)]&&setLogFormat(_0xf9efd1['log'][_0x180179(0x15c)]);initFileLogging();}catch(_0x4d67be){console[_0x180179(0x179)]('初始化日志系统出错:\x20'+_0x4d67be[_0x180179(0x174)]);}}initialize(),module[a0_0x41baca(0x183)]={'LOG_LEVELS':LOG_LEVELS,'setLogLevel':setLogLevel,'setLogFormat':setLogFormat,'error':error,'warn':warn,'info':info,'debug':debug,'trace':trace,'http':http,'enableFileLogging':()=>{const _0x223ace=a0_0x41baca;if(ensureLogDirExists())return logToFile=!![],info(_0x223ace(0x18b)),!![];return![];},'disableFileLogging':()=>{const _0xac930c=a0_0x41baca;logToFile=![],info(_0xac930c(0x148));},'rotateLogFile':rotateLogFile,'getLogs':getLogs,'clearMemoryLogs':clearMemoryLogs};