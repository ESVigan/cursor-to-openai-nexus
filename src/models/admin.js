function a0_0x4957(_0x1524ff,_0x5c2e08){const _0x3721e8=a0_0x1351();return a0_0x4957=function(_0x1490fa,_0xc85c98){_0x1490fa=_0x1490fa-0x132;let _0x13515d=_0x3721e8[_0x1490fa];if(a0_0x4957['XmysvE']===undefined){var _0x4957be=function(_0x3fa810){const _0x3578c4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x15eaa0='',_0xb5af9d='',_0x595b70=_0x15eaa0+_0x4957be;for(let _0x8915ac=0x0,_0x2ae885,_0x5b9d9c,_0x416075=0x0;_0x5b9d9c=_0x3fa810['charAt'](_0x416075++);~_0x5b9d9c&&(_0x2ae885=_0x8915ac%0x4?_0x2ae885*0x40+_0x5b9d9c:_0x5b9d9c,_0x8915ac++%0x4)?_0x15eaa0+=_0x595b70['charCodeAt'](_0x416075+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x2ae885>>(-0x2*_0x8915ac&0x6)):_0x8915ac:0x0){_0x5b9d9c=_0x3578c4['indexOf'](_0x5b9d9c);}for(let _0x182f20=0x0,_0x24a866=_0x15eaa0['length'];_0x182f20<_0x24a866;_0x182f20++){_0xb5af9d+='%'+('00'+_0x15eaa0['charCodeAt'](_0x182f20)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xb5af9d);};a0_0x4957['zMfmvr']=_0x4957be,_0x1524ff=arguments,a0_0x4957['XmysvE']=!![];}const _0x3a92b5=_0x3721e8[0x0],_0x21f447=_0x1490fa+_0x3a92b5,_0xd8cc17=_0x1524ff[_0x21f447];if(!_0xd8cc17){const _0x20484c=function(_0x4ead62){this['cEyclV']=_0x4ead62,this['MhThOi']=[0x1,0x0,0x0],this['Ljvydh']=function(){return'newState';},this['piHNWt']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['wHUTgT']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x20484c['prototype']['Kddjri']=function(){const _0x2c3d21=new RegExp(this['piHNWt']+this['wHUTgT']),_0xfc25ea=_0x2c3d21['test'](this['Ljvydh']['toString']())?--this['MhThOi'][0x1]:--this['MhThOi'][0x0];return this['kFNXxU'](_0xfc25ea);},_0x20484c['prototype']['kFNXxU']=function(_0x35899e){if(!Boolean(~_0x35899e))return _0x35899e;return this['FzpAes'](this['cEyclV']);},_0x20484c['prototype']['FzpAes']=function(_0x4f8b31){for(let _0x303ae0=0x0,_0x1b3c39=this['MhThOi']['length'];_0x303ae0<_0x1b3c39;_0x303ae0++){this['MhThOi']['push'](Math['round'](Math['random']())),_0x1b3c39=this['MhThOi']['length'];}return _0x4f8b31(this['MhThOi'][0x0]);},new _0x20484c(a0_0x4957)['Kddjri'](),_0x13515d=a0_0x4957['zMfmvr'](_0x13515d),_0x1524ff[_0x21f447]=_0x13515d;}else _0x13515d=_0xd8cc17;return _0x13515d;},a0_0x4957(_0x1524ff,_0x5c2e08);}const a0_0x482d97=a0_0x4957;(function(_0x3919cb,_0x871992){const _0x25926f=a0_0x4957,_0x28ea77=_0x3919cb();while(!![]){try{const _0x345715=parseInt(_0x25926f(0x147))/0x1+parseInt(_0x25926f(0x159))/0x2*(-parseInt(_0x25926f(0x146))/0x3)+-parseInt(_0x25926f(0x135))/0x4+parseInt(_0x25926f(0x155))/0x5+-parseInt(_0x25926f(0x137))/0x6+-parseInt(_0x25926f(0x141))/0x7+parseInt(_0x25926f(0x157))/0x8;if(_0x345715===_0x871992)break;else _0x28ea77['push'](_0x28ea77['shift']());}catch(_0x13630f){_0x28ea77['push'](_0x28ea77['shift']());}}}(a0_0x1351,0x35e8d));const a0_0xc85c98=(function(){let _0xb5af9d=!![];return function(_0x595b70,_0x8915ac){const _0x2ae885=_0xb5af9d?function(){const _0x1f6c2f=a0_0x4957;if(_0x8915ac){const _0x5b9d9c=_0x8915ac[_0x1f6c2f(0x15b)](_0x595b70,arguments);return _0x8915ac=null,_0x5b9d9c;}}:function(){};return _0xb5af9d=![],_0x2ae885;};}()),a0_0x1490fa=a0_0xc85c98(this,function(){const _0x5b768b=a0_0x4957;return a0_0x1490fa[_0x5b768b(0x149)]()[_0x5b768b(0x144)]('(((.+)+)+)+$')['toString']()[_0x5b768b(0x15c)](a0_0x1490fa)[_0x5b768b(0x144)](_0x5b768b(0x132));});a0_0x1490fa();const fs=require('fs'),path=require(a0_0x482d97(0x160)),crypto=require(a0_0x482d97(0x148)),jwt=require(a0_0x482d97(0x152)),ADMIN_FILE=path[a0_0x482d97(0x156)](__dirname,a0_0x482d97(0x158)),JWT_SECRET=process['env'][a0_0x482d97(0x13f)]||a0_0x482d97(0x139),dataDir=path[a0_0x482d97(0x142)](ADMIN_FILE);function a0_0x1351(){const _0x32dbc7=['DMvYAwz5','zxHPC3rZu3LUyW','CMvHzezPBgvtEw5J','DMvYAwz5vg9Rzw4','sLDux1nfq1jfva','DxrMoa','mJK0ntC5nM9zrg9Rra','zgLYBMfTzq','5BEY5A2y5zYO566H55cg5zgy6lsM5y+3','C2vHCMnO','Bg9HzefKBwLU','mZmYota0sNbVsef2','nZi5mdfbwwDbCvu','y3j5ChrV','Dg9tDhjPBMC','zxHWB3j0CW','D3jPDgvgAwXLu3LUyW','DxnLCM5HBwu','C2HHnteY','zxjYB3i','AgfZqwrTAw4','C2fSDa','C2f2zufKBwLU','ANnVBNDLyNrVA2vU','z2vUzxjHDgvuB2TLBG','DMvYAwz5ugfZC3DVCMq','odC1ndvyDhLjBxq','AM9PBG','nZa2odaWmfv3zLjrrW','lI4VlI4Vzgf0ys9Hzg1PBI5QC29U','ngXKBuLzEq','CgfYC2u','yxbWBhK','y29UC3rYDwn0B3i','Agv4','CgjRzgyYu3LUyW','C3rYAw5NAwz5','Cgf0Aa','5l+D5A2y566H55cg5zgy5PwW5O2U5AsX6lsLoG','kcGOlISPkYKRksSK','55sO5OI35zcn5OIw5A+g56cb6zsz6k+V','CMvNAxn0zxi','odm2ndbfEufguu8','mJrO','ntm2ntm4swfbDLDP','ywrTAw4','Ew91CI1ZzwnYzxqTA2v5','C2LNBG'];a0_0x1351=function(){return _0x32dbc7;};return a0_0x1351();}!fs[a0_0x482d97(0x13c)](dataDir)&&fs['mkdirSync'](dataDir,{'recursive':!![]});!fs[a0_0x482d97(0x13c)](ADMIN_FILE)&&fs[a0_0x482d97(0x14b)](ADMIN_FILE,JSON[a0_0x482d97(0x15f)]({'admin':null}),'utf8');class Admin{constructor(){const _0x50c2a5=a0_0x482d97;this[_0x50c2a5(0x145)]();}[a0_0x482d97(0x145)](){const _0x1b945a=a0_0x482d97;try{const _0x416075=fs[_0x1b945a(0x13d)](ADMIN_FILE,_0x1b945a(0x140));this[_0x1b945a(0x138)]=JSON[_0x1b945a(0x15a)](_0x416075)[_0x1b945a(0x138)];}catch(_0x182f20){console['error']('加载管理员数据失败:',_0x182f20),this['admin']=null;}}[a0_0x482d97(0x151)](){const _0x4dc316=a0_0x482d97;try{fs[_0x4dc316(0x14b)](ADMIN_FILE,JSON[_0x4dc316(0x15f)]({'admin':this[_0x4dc316(0x138)]}),_0x4dc316(0x140));}catch(_0x24a866){console[_0x4dc316(0x14e)](_0x4dc316(0x161),_0x24a866);throw _0x24a866;}}[a0_0x482d97(0x14f)](){return!!this['admin'];}[a0_0x482d97(0x134)](_0x20484c,_0x4ead62){const _0x405f8f=a0_0x482d97;if(this[_0x405f8f(0x14f)]())throw new Error(_0x405f8f(0x143));const _0x2c3d21=crypto['randomBytes'](0x10)[_0x405f8f(0x149)](_0x405f8f(0x15d)),_0xfc25ea=crypto[_0x405f8f(0x15e)](_0x4ead62,_0x2c3d21,0x3e8,0x40,_0x405f8f(0x14d))[_0x405f8f(0x149)]('hex');return this[_0x405f8f(0x138)]={'username':_0x20484c,'salt':_0x2c3d21,'hash':_0xfc25ea},this[_0x405f8f(0x151)](),this[_0x405f8f(0x153)](_0x20484c);}[a0_0x482d97(0x154)](_0x35899e,_0x4f8b31,_0x303ae0){const _0x203d35=a0_0x482d97,_0x1b3c39=crypto[_0x203d35(0x15e)](_0x35899e,_0x4f8b31,0x3e8,0x40,'sha512')[_0x203d35(0x149)](_0x203d35(0x15d));return _0x1b3c39===_0x303ae0;}['login'](_0x1d2a3c,_0x365487){const _0x1820e2=a0_0x482d97;if(!this['admin']||_0x1d2a3c!==this['admin']['username'])throw new Error(_0x1820e2(0x133));if(!this[_0x1820e2(0x154)](_0x365487,this[_0x1820e2(0x138)][_0x1820e2(0x150)],this[_0x1820e2(0x138)]['hash']))throw new Error(_0x1820e2(0x133));return this[_0x1820e2(0x153)](_0x1d2a3c);}[a0_0x482d97(0x153)](_0x3c6304){const _0xb9125c=a0_0x482d97;return jwt[_0xb9125c(0x13a)]({'username':_0x3c6304},JWT_SECRET,{'expiresIn':_0xb9125c(0x136)});}[a0_0x482d97(0x13e)](_0x1a6316){const _0xc3f972=a0_0x482d97;try{const _0x3fd5f2=jwt[_0xc3f972(0x13b)](_0x1a6316,JWT_SECRET);return{'success':!![],'username':_0x3fd5f2[_0xc3f972(0x14c)]};}catch(_0x39e217){return{'success':![],'error':'Invalid\x20token'};}}}module[a0_0x482d97(0x14a)]=new Admin();